<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>English Translator Tools</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <!-- Damn Geezer's Navbar -->
    <!-- <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column"> -->
    <nav
      class="navbar navbar-expand-lg navbar-dark w-100 bg-dark mb-3 text-light"
    >
      <div class="container-fluid">
        <a class="navbar-brand" href="#">English Translator Tools</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          a-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse flex-grow-1"
          id="navbarSupportedContent"
        >
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a href="#" class="nav-link active" aria-current="page">Home</a>
            </li>
            <li class="nav-item dropdown">
              <a
                href="#"
                class="nav-link dropdown-toggle"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >Wordlists</a
              >
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">List1</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item" href="#">New</a></li>
              </ul>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">Account</a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">Conatcts</a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">About Me</a>
            </li>
          </ul>
        </div>
      </div>
      <!-- End of the Damn Geezer's Navbar-->
      <!-- Damn Geezers Main element starts-->
    </nav>
    <div class="container my-2 d-flex flex-column mb-3">
      <main class="text-center" id="dic-element">
        <article class="row">
          <header class="pb-2">
            <h3>Here You Can Try Our Dictionary API</h3>
          </header>
          <ul
            class="d-flex flex-row justify-content-center color-grey text-secondary pb-2"
            style="list-style-type: none"
          >
            <li>Author: danial</li>
            <li class="px-2">Time: 2023-21-1</li>
          </ul>
          <div class="pb-2">
            <p>Here you can test the freedictionary API functionality.</p>
            <form action="" id="">
              <label for="dic-query">Query: </label>
              <input
                type="text"
                id="dic-query"
                class="px-2 w-50 mb-3"
                placeholder="Type an english word and press Enter"
              />
              <input type="button" value="Search" id="send" />
            </form>
          </div>
        </article>
        <article class="shadow p-3 mb-5 bg-body rounded">
          <!-- <input
            type="button"
            class="button"
            value="New"
            name="new"
            id="newarticle"
          />-->
          <input
            type="button"
            class="button"
            value="Save to Server"
            name="save"
            id="saveit"
          />
          <input
            type="button"
            class="button"
            value="Print"
            name="print"
            id="printoutput"
          />
        </article>
      </main>
      <aside></aside>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <script>
      class Card {
        constructor(id, content) {
          this.id = id;
          this.content = content;
          this.article = document.createElement("article");
          this.article.classList = "shadow p-3 mb-5 bg-body rounded";
          this.searchInput = document.createElement("input");
          this.applyButton = document.createElement("input");
          this.applyButton.type = "button";
          this.applyButton.value = "search";
          this.settingButton1 = document.createElement("input");
          this.settingButton1.type = "button";
          // this.settingButton1.value = "Free Dictionary";
          // this.settingButton2 = document.createElement("input");
          // this.settingButton2.type = "button";
          // this.settingButton2.value = "Merriam Webster";
          // this.settingButton3 = document.createElement("input");
          // this.settingButton3.type = "button";
          // this.settingButton3.value = "Wictionary";
          this.resultDiv = document.createElement("div");
          this.resultDiv.class = "resultDiv";
          this.resultPar = document.createElement("p");
          this.resultTitle = document.createElement("h3");
          this.resultTitle.innerText = "Result";
          this.resultPar.innerText = content;
        }
        makeCard(parentElement) {
          parentElement.append(this.article);
          this.article.append(
            this.searchInput,
            this.applyButton
            // this.settingButton1
            // this.settingButton2,
            // this.settingButton3
          );
          this.article.append(this.resultDiv);
          this.resultDiv.append(this.resultTitle, this.resultPar);
          // const settings = [
          //   [this.settingButton1, true],
          // [this.settingButton2, true],
          // [this.settingButton3, true],
          // ];
          // for (let i = 0; i < settings.length; i++) {
          //   settings[i][0].addEventListener("click", () => {
          //     let mine = settings[i][0]

          //   });
          // }
          let articleElements = [this.article, ...this.article.childNodes];
          // console.log(articleElements)
          for (let i = 0; i < articleElements.length; i++) {
            articleElements[i].id = `ca-card-${this.id}-${i}`;
          }
        }
      }
      let counter = 0;
      let cardList = [];
    </script>
    <script>
      let dicCard = function (parentElement, data) {
        if (counter < 10) {
          const card = new Card(counter, "test");
          cardList.push(card);
          cardList[counter].makeCard(parentElement);
          counter++;
          // console.log(cardList);
        }
        // data injection
        let cardIndex = cardList.length - 1;

        let cardId = "ca-card-" + cardIndex + "-3";
        let cardDiv = document.getElementById(cardId);
        cardDiv.innerText = "";
        // console.log(data);
        for (field of data) {
          let h3 = document.createElement("h3");
          h3.innerHTML = field.word;
          let phonetics = document.createElement("span");
          try {
            phonetics.innerText = field.phonetic;
          } catch (err) {}
          if (field.phonetic === undefined) {
            phonetics.innerText = "";
          }

          console.log(field);
          cardDiv.append(h3, phonetics);
          for (meaning of field.meanings) {
            meaning.definitions.forEach((element) => {
              let defPar = document.createElement("p");
              console.log(element);
              defPar.innerText =
                element.definition !== undefined ? element.definition : "";
              cardDiv.append(defPar);
            });
          }
        }
      };
      document.getElementById("send").onclick = function () {
        freedictionary(document.getElementById("dic-query").value);
      };
      document.getElementById("dic-query").onkeypress = function (e) {
        if (e.keyCode === 13) {
          freedictionary(document.getElementById("dic-query").value);
        }
      };
      let freedictionary = async function (query) {
        const res = await fetch(
          `https://api.dictionaryapi.dev/api/v2/entries/en/${query}`
        );
        const data = await res.json();
        dicCard(document.querySelector("#dic-element"), data);
        // console.log(data);
      };
      document.querySelector("#printoutput").onclick = function () {
        var printwin = window.open("");
        printwin.document.write(
          document.getElementById("dic-element").innerHTML
        );
        printwin.print();
      };
      document.querySelector("#saveit").addEventListener("click", function () {
        if (localStorage["activeUser"] !== undefined) {
          alert(localStorage["activeUser"]);
        } else {
          localStorage["activeUser"] = "guest";
          localStorage["guestNotebooks"] = "[]";
          console.log(localStorage["guestNotebooks"]);
        }
        if (localStorage["activeUser"] === "guest") {
          console.log(localStorage["guestNotebooks"]);
          let guestNotebooks = JSON.parse(localStorage["guestNotebooks"]);
          guestNotebooks.push(document.querySelector("main").innerHTML);
          localStorage["guestNotebooks"] = JSON.stringify(guestNotebooks);
          alert("success");
        }
        // else{
        //   let guestNotebooks = JSON.parse(localStorage[activeUser]["notebooks"])
        //   guestNotebooks.push(document.querySelector(#dic-element))
        //   localStorage["guestNotebooks"] = JSON.stringify(guestNotebooks)
        //   alert('success')
        //   console.log(localStorage[activeUser]["notebooks"])
        // }
        // localStorage["activeUser"]["notebooks"];
      });
    </script>
  </body>
</html>
